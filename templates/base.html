{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>{% block title %}BlitzQuest{% endblock %}</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {# --- Global CSS --- #}
    <link rel="stylesheet" href="{% static 'css/main.css' %}">

    {# --- Block for Page-Specific CSS/JS --- #}
    {% block extra_css %}{% endblock %}
    {% block extra_js %}{% endblock %}
</head>

<body class="{% block body_class %}{% endblock %}">
    <div class="page-root">
        {# --- Background Ambience --- #}
        <div class="bg-blur bg-blur-1"></div>
        <div class="bg-blur bg-blur-2"></div>

        {# --- Main Navigation Header --- #}
        <header class="site-header">
            <div class="site-header-inner">
                {# Brand Logo #}
                <a href="{% url 'game:home' %}" class="brand">
                    <div class="brand-logo">BQ</div>
                    <div class="brand-text">
                        <span class="brand-title">BlitzQuest</span>
                        <span class="brand-subtitle">Knowledge Board Duel</span>
                    </div>
                </a>

                {# Navigation Links #}
                <nav class="main-nav">
                    <a href="{% url 'game:home' %}"
                        class="{% if request.resolver_match.url_name == 'home' %}active{% endif %}">Home</a>
                    <a href="{% url 'game:game_list' %}"
                        class="{% if request.resolver_match.url_name == 'game_list' %}active{% endif %}">Games</a>
                    <a href="{% url 'game:game_create' %}"
                        class="{% if request.resolver_match.url_name == 'game_create' %}active{% endif %}">Create</a>
                    <a href="{% url 'game:game_join' %}"
                        class="{% if request.resolver_match.url_name == 'game_join' %}active{% endif %}">Join</a>
                </nav>

                {# User Menu / Authentication Actions #}
                <div class="user-nav">
                    {% if user.is_authenticated %}
                    <div class="user-menu-container">
                        <button class="user-menu-trigger" aria-label="Open user menu">
                            <div class="user-avatar">
                                {{ user.username|make_list|first|upper }}
                            </div>
                            <div class="user-info">
                                <span class="user-name">{{ user.username }}</span>
                                <span class="user-status">Account settings</span>
                            </div>
                        </button>
                        <div class="user-dropdown">
                            <a href="{% url 'game:profile' %}" class="dropdown-item">
                                Profile
                            </a>
                            <form method="post" action="{% url 'logout' %}" class="logout-form-item">
                                {% csrf_token %}
                                <button type="submit" class="dropdown-item text-danger">Logout</button>
                            </form>
                        </div>
                    </div>
                    {% else %}
                    <a href="{% url 'login' %}" class="btn btn-outline-small">Login</a>
                    <a href="{% url 'signup' %}" class="btn btn-primary-small">Sign Up</a>
                    {% endif %}
                </div>
            </div>
        </header>

        {# --- Main Content Area --- #}
        <main class="site-main {% block main_class %}{% endblock %}">
            {# Flash Messages (Success/Error/Info) #}
            {% if messages %}
            <div class="message-container">
                {% for message in messages %}
                <div class="message message-{{ message.tags }}">
                    {{ message }}
                </div>
                {% endfor %}
            </div>
            {% endif %}

            {# Page Content Block #}
            {% block content %}
            {% endblock %}
        </main>

        {# --- Footer --- #}
        <footer class="site-footer">
            <div class="site-footer-inner">
                <span>&copy; {{ request.META.SERVER_NAME }} — BlitzQuest</span>
                <span class="footer-hint">2–4 player Django board game prototype</span>
            </div>
        </footer>
    </div>

    {# --- Global Scripts --- #}
    <script src="{% static 'js/main.js' %}"></script>
</body>

</html>